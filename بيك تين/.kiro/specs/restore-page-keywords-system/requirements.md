# استعادة نظام إدارة الكلمات المفتاحية من قاعدة البيانات

## نظرة عامة

استعادة نظام إدارة الكلمات المفتاحية الذي كان يعمل سابقاً عبر جدول `page_keywords` في قاعدة البيانات.

## المشكلة الحالية

- جدول `page_keywords` يحتوي على 5 سجلات فقط
- كان يحتوي سابقاً على مئات الكلمات المفتاحية (120 كلمة لكل صفحة)
- لوحة التحكم `/admin/page-keywords` لا تعرض البيانات المفقودة
- الكلمات المفتاحية حالياً تأتي من ملفات `lib/keywords/*.ts` فقط

## المتطلبات الوظيفية

### المتطلب 1: استعادة البيانات المفقودة

**قصة المستخدم:** كمطور، أريد استعادة البيانات المفقودة من جدول page_keywords، حتى أتمكن من إدارة الكلمات المفتاحية من لوحة التحكم.

#### معايير القبول

1. WHEN البحث عن نسخة احتياطية، THE النظام SHALL يحدد ملف قاعدة البيانات الذي يحتوي على أكبر عدد من سجلات page_keywords
2. WHEN استعادة البيانات، THE النظام SHALL يحافظ على البيانات الحالية الـ 5 سجلات
3. WHEN اكتمال الاستعادة، THE جدول page_keywords SHALL يحتوي على 100+ سجل
4. WHILE عملية الاستعادة، THE النظام SHALL ينشئ نسخة احتياطية من قاعدة البيانات الحالية
5. IF فشلت عملية الاستعادة، THEN THE النظام SHALL يعيد قاعدة البيانات لحالتها الأصلية

### المتطلب 2: إصلاح لوحة التحكم

**قصة المستخدم:** كمدير محتوى، أريد إدارة الكلمات المفتاحية من لوحة التحكم، حتى أتمكن من تخصيص الكلمات لكل صفحة.

#### معايير القبول

1. WHEN زيارة صفحة /admin/page-keywords، THE النظام SHALL يعرض جميع الكلمات المفتاحية المستعادة
2. WHEN البحث في الكلمات، THE النظام SHALL يفلتر النتائج حسب النص المدخل
3. WHEN الفلترة حسب نوع الصفحة، THE النظام SHALL يعرض الكلمات للنوع المحدد فقط
4. WHEN إضافة كلمة جديدة، THE النظام SHALL يحفظها في قاعدة البيانات
5. WHEN تعديل كلمة موجودة، THE النظام SHALL يحدث البيانات في قاعدة البيانات
6. WHEN حذف كلمة، THE النظام SHALL يزيلها من قاعدة البيانات

### المتطلب 3: ربط النظام بالواجهة الأمامية

**قصة المستخدم:** كزائر للموقع، أريد رؤية الكلمات المفتاحية ذات الصلة في كل صفحة أداة، حتى أتمكن من اكتشاف أدوات أخرى مفيدة.

#### معايير القبول

1. WHEN عرض صفحة أداة، THE مكون KeywordsSection SHALL يحاول جلب الكلمات من قاعدة البيانات أولاً
2. IF لم توجد كلمات في قاعدة البيانات، THEN THE النظام SHALL يستخدم ملفات lib/keywords/\*.ts كبديل
3. WHEN عرض الكلمات، THE النظام SHALL يعرض 50+ كلمة مفتاحية لكل صفحة
4. WHILE تحميل الكلمات، THE النظام SHALL يعرض مؤشر تحميل
5. IF فشل تحميل الكلمات، THEN THE النظام SHALL يعرض رسالة خطأ مناسبة

## المتطلبات التقنية

### قاعدة البيانات

- جدول `page_keywords` موجود بالهيكل الصحيح
- دعم الترميز العربي UTF-8
- فهرسة على حقول page_type و page_slug

### APIs المطلوبة

- `/api/admin/page-keywords` - إدارة الكلمات
- `/api/admin/page-keywords/[id]` - تعديل وحذف
- `/api/page-keywords/[type]/[slug]` - جلب كلمات للواجهة

### المكونات

- `KeywordsSection` محدث ليقرأ من قاعدة البيانات
- صفحة إدارة الكلمات محدثة
- APIs محدثة ومختبرة

## معايير القبول العامة

### استعادة البيانات

- جدول page_keywords يحتوي على 100+ سجل
- كل سجل يحتوي على 50+ كلمة مفتاحية
- البيانات تغطي جميع الأدوات والصفحات الرئيسية
- الترميز العربي سليم

### لوحة التحكم

- صفحة /admin/page-keywords تعمل بدون أخطاء
- عرض جميع الكلمات في جدول منظم
- إمكانية البحث والفلترة
- إمكانية التعديل والحذف والإضافة

### الواجهة الأمامية

- قسم "مواضيع ذات صلة" يظهر الكلمات من قاعدة البيانات
- في حالة عدم وجود بيانات، يعرض كلمات من ملفات lib/keywords
- الكلمات تظهر بشكل صحيح في جميع صفحات الأدوات
- سرعة تحميل مقبولة (< 2 ثانية)

## الأولوية

**عالية جداً** - هذا النظام كان يعمل سابقاً ومطلوب استعادته فوراً

## الملاحظات

- عدم إنشاء جداول جديدة أو تعديل هيكل قاعدة البيانات
- التركيز على استعادة البيانات المفقودة فقط
- الحفاظ على النظام الحالي كـ fallback في حالة عدم وجود بيانات
